[
    {
        "SysType": "Scader",
        "CmdsAtStart": "",
        "WebUI": "",
        "SysManager": {
            "monitorPeriodMs":30000,
            "reportList":[
                "NetMan",
                "BLEMan",
                "SysMan",
                "ProtExchg",
                "StatsCB"
            ],
            "pauseWiFiforBLE":1,
            "slowSysModMs": 100,
            "rebootAfterNHours": 24,
            "rebootIfDiscMins": 10
        },
        "LogManager": {
            "logDests": [
                {
                    "enable": true,
                    "type": "Papertrail",
                    "host": "logs2.papertrailapp.com",
                    "port": 48992,
                    "sysName": "Scader"
                }
            ]
        },
        "ProtExchg": {
            "RICSerial":{
                "FrameBound":"0xE7",
                "CtrlEscape":"0xD7"
            }
        },
        "NetMan": {
            "wifiSTAEn": 1,
            "wifiAPEn": 0,
            "ethEn": 1,
            "wifiSSID": "",
            "wifiPW": "",
            "wifiSTAScanThreshold": "OPEN",
            "wifiAPSSID": "",
            "wifiAPPW": "",
            "wifiAPChannel": 1,
            "wifiAPMaxConn": 4,
            "wifiAPAuthMode": "WPA2_PSK",
            "ethLanChip": "LAN87XX",
            "ethPowerPin": [
                {"__hwRevs__": [3,4], "__value__": 12}
            ],
            "ethMDCPin": 23,
            "ethMDIOPin": 18,
            "ethPhyAddr": 0,
            "ethPhyRstPin": -1,
            "NTPServer": "pool.ntp.org",
            "timezone": "UTC",
            "logLevel": "D"
        },
        "MQTTMan": {
            "enable": 1,
            "brokerHostname": "benbecula",
            "brokerPort": 1883,
            "clientID": "Scader",
            "topics": [
                {
                    "name": "scaderIn",
                    "inbound": 1,
                    "path": "scader/in",
                    "qos": 1
                },
                {
                    "name": "scaderOut",
                    "inbound": 0,
                    "path": "scader/out",
                    "qos": 1
                }
            ]
        },
        "NTPClient": {
            "enable": 1,
            "NTPServer": "pool.ntp.org",
            "GMTOffsetSecs": 0,
            "DSTOffsetSecs": 0
        },
        "ESPOTAUpdate": {
            "OTADirect": 1
        },
        "BLEMan": {
            "enable": 0,
            "outQSize": 15,
            "sendUseInd": 1,
            "logLevel": "D",
            "nimLogLev": "E"
        },
        "WebServer": {
            "enable": 1,
            "webServerPort": 80,
            "stdRespHeaders": [
                "Access-Control-Allow-Origin: *"
            ],
            "apiPrefix": "api/",
            "fileServer": 1,
            "numConnSlots": 12,
            "websockets": [
                {
                    "pfix": "ws",
                    "pcol": "RICSerial",
                    "maxConn": 4,
                    "txQueueMax": 20,
                    "pingMs": 30000
                },
                {
                    "pfix": "scader",
                    "pcol": "RICJSON",
                    "maxConn": 4,
                    "txQueueMax": 20,
                    "pingMs": 30000,
                    "content": "text"
                }
            ],
            "logLevel": "D",
            "sendMax": 5000,
            "taskCore": 0,
            "taskStack": 5000,
            "taskPriority": 9
        },
        "SerialConsole": {
            "enable": 1,
            "uartNum": 0,
            "rxBuf": 5000,
            "txBuf": 1500,
            "crlfOnTx": 1,
            "protocol": "RICSerial",
            "logLevel": "D"
        },
        "CommandSerial": {
            "logLevel": "D",
            "ports": [
                {
                    "name": "Serial1",
                    "enable": [
                        {"__hwRevs__": [2,4], "__value__": 1}
                    ],
                    "uartNum": 1,
                    "baudRate": 115200,
                    "rxBufSize": 8192,
                    "rxPin": [
                        {"__hwRevs__": [2], "__value__": 16},
                        {"__hwRevs__": [4], "__value__": 35}
                    ],
                    "txPin": [
                        {"__hwRevs__": [2], "__value__": 17},
                        {"__hwRevs__": [4], "__value__": 5}
                    ],
                    "protocol": "RICSerial",
                    "logLevel": "D"
                }
            ]
        },
        "CommandSocket": {
            "enable": 0,
            "socketPort": 24,
            "protocol": "RICSerial",
            "logLevel": "D"
        },
        "FileManager": {
            "SPIFFSEnabled": 1,
            "LittleFSEnabled": 0,
            "LocalFSFormatIfCorrupt": 1,
            "CacheFileSysInfo": 0,
            "SDEnabled": 0,
            "DefaultSD": 1,
            "SDMOSI": 15,
            "SDMISO": 4,
            "SDCLK": 14,
            "SDCS": 13
        },
        "Publish": {
            "pubList": [
                {
                    "type": "HW",
                    "name": "ScaderRelays",
                    "trigger": "Time",
                    "msgID": "ScaderRelays",
                    "rates": [
                        {
                            "if": "scaderOut",
                            "protocol": "RICJSON",
                            "rateHz": 0.1
                        }
                    ]
                },
                {
                    "type": "HW",
                    "name": "ScaderShades",
                    "trigger": "Time",
                    "msgID": "ScaderShades",
                    "rates": [
                        {
                            "if": "scaderOut",
                            "protocol": "RICJSON",
                            "rateHz": 0.1
                        }
                    ]
                },
                {
                    "type": "HW",
                    "name": "ScaderDoors",
                    "trigger": "Time",
                    "msgID": "ScaderDoors",
                    "rates": [
                        {
                            "if": "scaderOut",
                            "protocol": "RICJSON",
                            "rateHz": 0.1
                        }
                    ]
                },
                {
                    "type": "HW",
                    "name": "ScaderOpener",
                    "trigger": "Time",
                    "msgID": "ScaderOpener",
                    "rates": [
                        {
                            "if": "scaderOut",
                            "protocol": "RICJSON",
                            "rateHz": 0.1
                        }
                    ]
                },
                {
                    "type": "HW",
                    "name": "ScaderRFID",
                    "trigger": "Time",
                    "msgID": "ScaderRFID",
                    "rates": [
                        {
                            "if": "scaderOut",
                            "protocol": "RICJSON",
                            "rateHz": 0.1
                        }
                    ]
                }
            ]
        },
        "ScaderRelays": {
            "maxElems": 24,
            "SPI_MOSI": [
                {"__hwRevs__": [3], "__value__": 33}
            ],
            "SPI_MISO": [
                {"__hwRevs__": [3], "__value__": 32}
            ],
            "SPI_CLK": [
                {"__hwRevs__": [3], "__value__": 16}
            ],
            "SPI_CS1": [
                {"__hwRevs__": [3], "__value__": 4}
            ],
            "SPI_CS2": [
                {"__hwRevs__": [3], "__value__": 5}
            ],
            "SPI_CS3": [
                {"__hwRevs__": [3], "__value__": 13}
            ],
            "ONOFF_KEY": [
                {"__hwRevs__": [3], "__value__": 34}
            ],
            "MAINS_SYNC": [
                {"__hwRevs__": [3], "__value__": 35}
            ],
            "mainsSync": false,
            "enablePulseCounter": false,
            "pulseCounterPin": 39
        },
        "ScaderShades": {
            "maxElems": 5,
            "HC595_SER": [
                {"__hwRevs__": [4], "__value__": 16}
            ],
            "HC595_SCK": [
                {"__hwRevs__": [4], "__value__": 4}
            ],
            "HC595_LATCH": [
                {"__hwRevs__": [4], "__value__": 14}
            ],
            "HC595_RST": [
                {"__hwRevs__": [4], "__value__": 13}
            ],
            "LED_OP": -1,
            "LED_ACT": [
                {"__hwRevs__": [4], "__value__": 15}
            ],
            "enableLightLevels": 0,
            "LIGHTLVLPINS": [34, 39, -1]
        },
        "ScaderDoors": {
            "maxElems": 2,
            "doors": [
                {
                    "strikePin": [
                        {"__hwRevs__": [4], "__value__": 33}
                    ],
                    "strikeOn": 1,
                    "openSensePin": [
                        {"__hwRevs__": [4], "__value__": 34}
                    ],
                    "openSenseLevel": 0,
                    "unlockForSecs": 10
                },
                {
                    "strikePin": [
                        {"__hwRevs__": [4], "__value__": 32}
                    ],
                    "strikeOn": 1,
                    "openSensePin": -1,
                    "openSenseLevel": 0,
                    "unlockForSecs": 30,
                    "delayRelockSecs": 10
                }
            ],
            "masterDoorIdx": 0,
            "reportMasterDoorOnly": true,
            "bellSensePin": [
                {"__hwRevs__": [4], "__value__": 39}
            ],
            "bellSenseLevel": 1
        },
        "ScaderOpener": {
            "DoorRemainOpenTimeSecs": 45,
            "DoorTimeToOpenSecs": 20,
            "MotorOnTimeAfterMoveSecs": 5,
            "MaxMotorCurrentAmps": 0.4,
            "DoorOpenAngleDegs": 0,
            "DoorClosedAngleDegs": 0,
            "consvPirPin": 15,
            "consvButtonPin": 32,
            "i2cBusFreqHz": 100000,
            "MotorAndAngleSensor": {
                "BusI2C": {
                    "name": "I2CA",
                    "type": "I2C",
                    "reqFIFOLen": 10,
                    "i2cPort": 0,
                    "sdaPin": 21,
                    "sclPin": 22,
                    "i2cFreq": 100000,
                    "taskCore": 0,
                    "taskStack": 10000,
                    "taskPriority": 24                
                },
                "AngleSensor": {
                    "i2cAddr": 54,
                    "pollsPerSec": 1000,
                    "reverse": false,
                    "hysteresis": 0
                },            
                "MotorSerial":
                {
                    "name": "SERA",
                    "type": "serial",
                    "uartNum": 2,
                    "rxPin": "23",
                    "txPin": "4",
                    "baudRate": 115200,
                    "minAfterSendMs": 5
                },
                "DoorMotor":
                {
                    "name": "DoorMotor",
                    "type": "Steppers",
                    "bus": "SERA",
                    "motion": {
                        "geom": "XYZ",
                        "blockDist": 10,
                        "allowOutOfBounds": 0,
                        "homeBeforeMove": 0,
                        "junctionDeviation": 0.05
                    },
                    "ramp": {
                        "rampTimerEn": 1,
                        "rampTimerUs": 100,
                        "pipelineLen": 100
                    },
                    "motorEn": {
                        "stepEnablePin": "27",
                        "stepEnLev": 0,
                        "stepDisableSecs": 1
                    },
                    "axes": [
                        {
                            "name": "X",
                            "params": {
                                "unitsPerRot": 360,
                                "stepsPerRot": 28000,
                                "maxSpeed": 10,
                                "maxAcc": 10
                            },
                            "driver": {
                                "driver": "TMC2209",
                                "hw": "local",
                                "addr": 0,
                                "stepPin": "25",
                                "dirnPin": "26",
                                "invDirn": 0,
                                "writeOnly": 0,
                                "extSenseOhms": 0.15,
                                "extVRef": 0,
                                "extMStep": 0,
                                "intpol": 1,
                                "microsteps": 1,
                                "rmsAmps": 0.01,
                                "holdModeOrFactor": 0.5,
                                "holdDelay": 1,
                                "pwmFreqKHz": 35
                            }
                        }
                    ]
                }
            },
            "uiModule":
            {
                "rxPin": "19",
                "txPin": "18",
                "uartNum": 1,
                "baudRate": 115200	
            }

        },
        "ScaderCat": {
            "LIGHT_CTRL": 23,
            "VALVE_CTRL": 19,
            "FET_1": 18,
            "FET_2": 5
        },
        "ScaderLEDPix": {
            "brightness": 96,
            "strips": [
                {
                    "pixPin": "32",
                    "numPix": 500
                },
                {
                    "pixPin": "33",
                    "numPix": 500
                }
            ]
        },
        "ScaderWaterer": {
            "i2cPort": 0,
            "sdaPin": "21",
            "sclPin": "22",
            "i2cFreq": 100000,
            "adcI2CAddr": "0x48",
            "reportSecs": 10,
            "Pump0": "23",
            "Pump1": "25",
            "Pump2": "26",
            "Pump3": "27"
        },
        "ScaderRFID": {
            "actLedPin": [
                {"__hwRevs__": [2], "__value__": 15}
            ],
            "tagLedPin": [
                {"__hwRevs__": [2], "__value__": 23}
            ],
            "rfidSPIMOSIPin": [
                {"__hwRevs__": [2], "__value__": 18}
            ],
            "rfidSPIMISOPin": [
                {"__hwRevs__": [2], "__value__": 19}
            ],
            "rfidSPIClkPin": [
                {"__hwRevs__": [2], "__value__": 5}
            ],
            "rfidSPICS0Pin": [
                {"__hwRevs__": [2], "__value__": 21}
            ],
            "rfidNBusyPin": [
                {"__hwRevs__": [2], "__value__": 4}
            ],
            "rfidResetPin": [
                {"__hwRevs__": [2], "__value__": 22}
            ],
            "rfidResetActive": [
                {"__hwRevs__": [2], "__value__": 0}
            ],
            "rfidSPIHostID": [
                {"__hwRevs__": [2], "__value__": 1}
            ],
            "buzzerPin": [
                {"__hwRevs__": [2], "__value__": 13}
            ],
            "buzzerOnLevel": true,
            "buzzerOnMs": 100,
            "buzzerShortOffMs": 900,
            "buzzerLongOffMs": 1800
        }
    }
]
